document.addEventListener('DOMContentLoaded',function(){initializeCategoryDropdowns();initializeFilterButtons();initializeSearch();initializeTechFilters()});function initializeCategoryDropdowns(){const categoryItems=document.querySelectorAll('.category-item');categoryItems.forEach(item=>{const header=item.querySelector('.category-item-header');header.addEventListener('click',()=>{item.classList.toggle('active');categoryItems.forEach(otherItem=>{if(otherItem!==item&&otherItem.classList.contains('active')){otherItem.classList.remove('active')}})})})}
function initializeFilterButtons(){const filterButtons=document.querySelectorAll('.filter-btn');const portfolioItems=document.querySelectorAll('.portfolio-item');const sidebarFilterOptions=document.querySelectorAll('.filter-option');function filterPortfolioItems(filter){portfolioItems.forEach(item=>{const category=item.dataset.category;if(filter==='all'||category===filter){item.style.display='flex';item.style.animation='none';item.offsetHeight;item.style.animation=`slide-up 0.6s forwards ${parseFloat(item.style.getPropertyValue('--delay')) * 0.1}s`}else{item.style.display='none'}})}
filterButtons.forEach(button=>{button.addEventListener('click',()=>{filterButtons.forEach(btn=>btn.classList.remove('active'));button.classList.add('active');sidebarFilterOptions.forEach(option=>{if(option.dataset.filter===button.dataset.filter){option.classList.add('active')}else{option.classList.remove('active')}});filterPortfolioItems(button.dataset.filter);updateActiveFilters(button.dataset.filter,button.textContent)})});sidebarFilterOptions.forEach(option=>{option.addEventListener('click',()=>{sidebarFilterOptions.forEach(opt=>opt.classList.remove('active'));option.classList.add('active');filterButtons.forEach(btn=>{if(btn.dataset.filter===option.dataset.filter){btn.classList.add('active')}else{btn.classList.remove('active')}});filterPortfolioItems(option.dataset.filter);const filterName=option.querySelector('.filter-name').textContent.trim();updateActiveFilters(option.dataset.filter,filterName)})})}
function initializeSearch(){const searchInput=document.getElementById('search-input');const sidebarSearchInput=document.getElementById('sidebar-search-input');const searchBtn=document.getElementById('search-btn');const sidebarSearchBtn=document.getElementById('sidebar-search-btn');const portfolioItems=document.querySelectorAll('.portfolio-item');function performSearch(searchTerm){searchTerm=searchTerm.toLowerCase();portfolioItems.forEach(item=>{const title=item.querySelector('h3').textContent.toLowerCase();const description=item.querySelector('p').textContent.toLowerCase();const techTags=Array.from(item.querySelectorAll('.portfolio-tech span')).map(span=>span.textContent.toLowerCase());if(title.includes(searchTerm)||description.includes(searchTerm)||techTags.some(tag=>tag.includes(searchTerm))){item.style.display='flex';item.style.animation='none';item.offsetHeight;item.style.animation=`slide-up 0.6s forwards ${parseFloat(item.style.getPropertyValue('--delay')) * 0.1}s`}else{item.style.display='none'}});if(searchTerm){updateActiveFilters('search',`جستجو: ${searchTerm}`)}}
searchBtn.addEventListener('click',()=>{performSearch(searchInput.value)});sidebarSearchBtn.addEventListener('click',()=>{searchInput.value=sidebarSearchInput.value;performSearch(sidebarSearchInput.value)});searchInput.addEventListener('keypress',(e)=>{if(e.key==='Enter'){performSearch(searchInput.value)}});sidebarSearchInput.addEventListener('keypress',(e)=>{if(e.key==='Enter'){searchInput.value=sidebarSearchInput.value;performSearch(sidebarSearchInput.value)}})}
function initializeTechFilters(){const techCheckboxes=document.querySelectorAll('.tech-checkbox');const portfolioItems=document.querySelectorAll('.portfolio-item');function applyFilters(){const selectedTechs=Array.from(techCheckboxes).filter(checkbox=>checkbox.checked).map(checkbox=>checkbox.id.replace('tech-',''));if(selectedTechs.length===0){portfolioItems.forEach(item=>{item.style.display='flex'});return}
portfolioItems.forEach(item=>{const techTags=Array.from(item.querySelectorAll('.portfolio-tech span')).map(span=>span.textContent.toLowerCase());const matchesTech=selectedTechs.some(tech=>{if(tech==='python'&&techTags.some(tag=>tag.includes('python')))return!0;if(tech==='cpp'&&techTags.some(tag=>tag.includes('c++')))return!0;if(tech==='c'&&techTags.some(tag=>tag==='c'))return!0;if(tech==='assembly'&&techTags.some(tag=>tag.includes('assembly')))return!0;if(tech==='web'&&techTags.some(tag=>['flask','websocket','html','css','javascript'].some(webTech=>tag.includes(webTech))))return!0;return!1});if(matchesTech){item.style.display='flex';item.style.animation='none';item.offsetHeight;item.style.animation=`slide-up 0.6s forwards ${parseFloat(item.style.getPropertyValue('--delay')) * 0.1}s`}else{item.style.display='none'}});updateActiveFiltersFromCheckboxes()}
techCheckboxes.forEach(checkbox=>{checkbox.addEventListener('change',applyFilters)})}
function updateActiveFilters(filterType,filterText){const activeFiltersContainer=document.getElementById('active-filters');const existingFilters=activeFiltersContainer.querySelectorAll(`.filter-tag[data-type="${filterType}"]`);existingFilters.forEach(filter=>filter.remove());if(filterType==='all'){activeFiltersContainer.innerHTML='';return}
const filterTag=document.createElement('div');filterTag.className='filter-tag';filterTag.dataset.type=filterType;filterTag.innerHTML=`
        ${filterText}
        <span class="remove-tag" onclick="removeFilter(this)">×</span>
    `;activeFiltersContainer.appendChild(filterTag)}
function updateActiveFiltersFromCheckboxes(){const activeFiltersContainer=document.getElementById('active-filters');const existingTechFilters=activeFiltersContainer.querySelectorAll('.filter-tag[data-type^="tech-"]');existingTechFilters.forEach(filter=>filter.remove());const techCheckboxes=document.querySelectorAll('.tech-checkbox:checked');techCheckboxes.forEach(checkbox=>{const techLabel=checkbox.nextElementSibling.textContent;const filterTag=document.createElement('div');filterTag.className='filter-tag';filterTag.dataset.type=`tech-${checkbox.id}`;filterTag.innerHTML=`
            تکنولوژی: ${techLabel}
            <span class="remove-tag" onclick="removeFilter(this, '${checkbox.id}')">×</span>
        `;activeFiltersContainer.appendChild(filterTag)})}
function removeFilter(element,checkboxId){const filterTag=element.parentElement;const filterType=filterTag.dataset.type;filterTag.remove();if(checkboxId){const checkbox=document.getElementById(checkboxId);if(checkbox){checkbox.checked=!1;const event=new Event('change');checkbox.dispatchEvent(event)}
return}
if(filterType==='search'){document.getElementById('search-input').value='';document.getElementById('sidebar-search-input').value=''}
if(!filterType.startsWith('tech-')){document.querySelectorAll('.filter-btn').forEach(btn=>{btn.classList.remove('active');if(btn.dataset.filter==='all'){btn.classList.add('active')}});document.querySelectorAll('.filter-option').forEach(option=>{option.classList.remove('active');if(option.dataset.filter==='all'){option.classList.add('active')}});document.querySelectorAll('.portfolio-item').forEach(item=>{item.style.display='flex';item.style.animation='none';item.offsetHeight;item.style.animation=`slide-up 0.6s forwards ${parseFloat(item.style.getPropertyValue('--delay')) * 0.1}s`})}}
document.addEventListener('DOMContentLoaded',function(){const matrixRain=document.getElementById('matrix-rain');const columns=Math.floor(window.innerWidth/20);const chars='ابپتثجچحخدذرزژسشصضطظعغفقکگلمنوهی۰۱۲۳۴۵۶۷۸۹ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';for(let i=0;i<columns;i++){const column=document.createElement('div');column.className='matrix-column';column.style.setProperty('--speed',5+Math.random()*10);column.style.setProperty('--delay',Math.random()*5);column.style.setProperty('--column-delay',i*0.1);const charsCount=20+Math.floor(Math.random()*20);for(let j=0;j<charsCount;j++){const char=document.createElement('span');char.className='matrix-character';char.textContent=chars[Math.floor(Math.random()*chars.length)];char.style.setProperty('--char-index',j);column.appendChild(char)}
matrixRain.appendChild(column)}})